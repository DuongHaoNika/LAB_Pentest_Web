import libxmljs from "libxmljs"
import xmlparser from "express-xml-bodyparser"

// [GET] shop-cart
const getShopCart = (req, res) => {
  return res.render("shop-cart");
};

// [POST] shop-cart
const addCart = async (req, res) => {
  // try {
  //   let input = req.body
  //   console.log(req)
  //   // console.log(input.product.productId, input.product.quantity)
  //   // if(!input.product.productId || !input.product.quantity) {
  //   //   console.log('err!!!')
  //   //   return res.status(400).send('No data provided!')
  //   // }
  //   console.log(input.product)
  // } catch (error) {
  //     console.error("Error parsing XML:", error);
  // }
  const xmlData = `<?xml version="1.0" encoding="UTF-8"?>
  <!DOCTYPE data [
  <!ENTITY example SYSTEM "file:///etc/passwd">
  ]>
  <data>&example;</data>`;

  try {
    console.log(req.body)
    // xmlData = req.body
    // console.log(xmlData)
    // Parse the XML with external entity loading enabled
    const xmlDoc = libxmljs.parseXml(req.body, { replaceEntities: true, preserveWhitespace: true });
    const data = xmlDoc.root().text();
    console.log(data);
  } catch (error) {
    console.error("Error parsing XML:", error);
  }
  res.json({ redirectUrl: '/shop-cart' })
}

export default { getShopCart, addCart };
