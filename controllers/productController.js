import productService from "../services/productService";

const getProduct = async (req, res) => {
  const query = req.query;
  if (query.id) {
    try {
      const product = await productService.getProductById(parseInt(query.id));
      res.render("shop-product-right", {
        product,
      });
    } catch (err) {
      console.log(err);
      res.render("page-404");
    }
  } else {
    res.render("page-404");
  }
};

export default { getProduct };

// import productService from "../services/productService";

// const _JS_IDENTIFIER = /^[a-zA-Z_$][0-9a-zA-Z_$]*$/;

// const getProduct = async (req, res) => {
//   const query = req.query;
//   if (query.id && _JS_IDENTIFIER.test(query.id)) {
//     try {
//       const product = await productService.getProductById(parseInt(query.id));
//       res.render("shop-product-right", {
//         product,
//       });
//     } catch (err) {
//       console.log(err);
//       res.render("page-404");
//     }
//   } else {
//     res.render("page-404");
//   }
// };

// const getProduct = async (req, res) => {
//   const query = req.query;
//   // Regex để kiểm tra sự hiện diện của dấu '&'
//   const forbiddenCharacterRegex = /[&]/;

//   if (query.id && !forbiddenCharacterRegex.test(query.id)) {
//     try {
//       const product = await productService.getProductById(parseInt(query.id));
//       res.render("shop-product-right", {
//         product,
//       });
//     } catch (err) {
//       console.log(err);
//       res.render("page-404");
//     }
//   } else {
//     res.render("page-404");
//   }
// };

// export default { getProduct };